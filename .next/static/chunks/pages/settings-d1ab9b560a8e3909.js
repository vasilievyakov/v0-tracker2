(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{2837:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return r(6122)}])},6122:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(7568),n=r(7582),a=r(5893),i=r(7294),c=r(5739),l=r(2685),o=r(3223),d=r(4345),u=r(6209),h=r(767),p=r(1408),m=r(889);const x=(0,r(1373).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var f=r(1664),v=r.n(f);function j(){var e=(0,i.useState)(!1),t=e[0],r=e[1],f=(0,i.useState)(!1),j=f[0],g=f[1],y=(0,i.useState)("api"),N=y[0],b=y[1],w=(0,i.useState)(""),_=w[0],C=w[1],k=(0,i.useState)(""),A=k[0],P=k[1],S=(0,i.useState)(""),T=S[0],E=S[1],I=(0,i.useState)(null),F=I[0],Z=I[1],z=(0,i.useState)(!1),q=z[0],O=z[1],Y=(0,h.pm)().toast,D=function(){var e=(0,s.Z)((function(e){var t,s,a,i;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:e.preventDefault(),r(!0),t=new FormData(e.currentTarget),s=t.get("api_id"),a=t.get("api_hash"),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,u.yV)(s,a)];case 2:return(i=n.sent()).success?Y({title:"Settings saved",description:"Your Telegram API credentials have been saved."}):Y({title:"Error",description:i.error||"Failed to save settings.",variant:"destructive"}),[3,5];case 3:return n.sent(),Y({title:"Error",description:"An unexpected error occurred.",variant:"destructive"}),[3,5];case 4:return r(!1),[7];case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,s.Z)((function(){var e;return(0,n.__generator)(this,(function(t){switch(t.label){case 0:g(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,(0,u.ce)()];case 2:return(e=t.sent()).success?Y({title:"Connection successful",description:e.message||"Your Telegram API credentials are working correctly."}):Y({title:"Connection failed",description:e.error||"Failed to connect to Telegram API.",variant:"destructive"}),[3,5];case 3:return t.sent(),Y({title:"Error",description:"An unexpected error occurred.",variant:"destructive"}),[3,5];case 4:return g(!1),[7];case 5:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,s.Z)((function(){var e;return(0,n.__generator)(this,(function(t){switch(t.label){case 0:if(!_)return Y({title:"Error",description:"Please enter your phone number",variant:"destructive"}),[2];r(!0),t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,fetch("/api/telegram/auth/request-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:_})})];case 2:return[4,t.sent().json()];case 3:return(e=t.sent()).success?(Z(e.phoneCodeHash),b("code"),Y({title:"Code sent",description:"Please check your Telegram app for the verification code."})):Y({title:"Error",description:e.error||"Failed to send verification code",variant:"destructive"}),[3,6];case 4:return t.sent(),Y({title:"Error",description:"An unexpected error occurred.",variant:"destructive"}),[3,6];case 5:return r(!1),[7];case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,s.Z)((function(){var e;return(0,n.__generator)(this,(function(t){switch(t.label){case 0:if(!A||!F)return Y({title:"Error",description:"Please enter the verification code",variant:"destructive"}),[2];r(!0),t.label=1;case 1:return t.trys.push([1,4,5,6]),[4,fetch("/api/telegram/auth/sign-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:_,phoneCodeHash:F,code:A,password:q?T:void 0})})];case 2:return[4,t.sent().json()];case 3:return(e=t.sent()).success?(b("completed"),Y({title:"Authentication successful",description:"You have successfully authenticated with Telegram."})):e.requiresPassword?(O(!0),b("password"),Y({title:"2FA Required",description:"Please enter your 2FA password"})):Y({title:"Error",description:e.error||"Failed to sign in",variant:"destructive"}),[3,6];case 4:return t.sent(),Y({title:"Error",description:"An unexpected error occurred.",variant:"destructive"}),[3,6];case 5:return r(!1),[7];case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-balance",children:"Settings"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Configure your Telegram API credentials and authenticate"})]})]}),(0,a.jsx)(v(),{href:"/",children:(0,a.jsx)(c.z,{variant:"outline",children:"Back to Dashboard"})})]}),(0,a.jsxs)("div",{className:"space-y-6 max-w-2xl",children:[(0,a.jsxs)(d.Zb,{children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsx)(d.ll,{children:"Telegram API Configuration"}),(0,a.jsxs)(d.SZ,{children:["Enter your Telegram API credentials to automatically fetch channel data. Get your API ID and Hash from"," ",(0,a.jsx)("a",{href:"https://my.telegram.org",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"my.telegram.org"})]})]}),(0,a.jsx)(d.aY,{children:(0,a.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(o._,{htmlFor:"api_id",children:"API ID"}),(0,a.jsx)(l.I,{id:"api_id",name:"api_id",type:"number",placeholder:"12345678",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(o._,{htmlFor:"api_hash",children:"API Hash"}),(0,a.jsx)(l.I,{id:"api_hash",name:"api_hash",placeholder:"0123456789abcdef0123456789abcdef",required:!0})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{type:"submit",disabled:t,children:[t&&(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Settings"]}),(0,a.jsxs)(c.z,{type:"button",variant:"outline",onClick:B,disabled:j,children:[j&&(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Test Connection"]})]})]})})]}),(0,a.jsxs)(d.Zb,{children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsx)(d.ll,{children:"Telegram Authentication"}),(0,a.jsx)(d.SZ,{children:"Authenticate with your Telegram account to enable channel data collection"})]}),(0,a.jsxs)(d.aY,{className:"space-y-4",children:["api"===N&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"First, save your API credentials above, then proceed with authentication."}),(0,a.jsx)(c.z,{onClick:function(){return b("phone")},disabled:t,className:"w-full",children:"Start Authentication"})]}),"phone"===N&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(o._,{htmlFor:"phone",children:"Phone Number"}),(0,a.jsx)(l.I,{id:"phone",type:"tel",placeholder:"+1234567890",value:_,onChange:function(e){return C(e.target.value)},required:!0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter your phone number in international format (e.g., +1234567890)"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{onClick:H,disabled:t||!_,className:"flex-1",children:[t&&(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Send Code"]}),(0,a.jsx)(c.z,{variant:"outline",onClick:function(){return b("api")},disabled:t,children:"Back"})]})]}),"code"===N&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(o._,{htmlFor:"code",children:"Verification Code"}),(0,a.jsx)(l.I,{id:"code",type:"text",placeholder:"12345",value:A,onChange:function(e){return P(e.target.value)},required:!0,maxLength:6}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter the verification code sent to your Telegram app"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{onClick:V,disabled:t||!A,className:"flex-1",children:[t&&(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Verify Code"]}),(0,a.jsx)(c.z,{variant:"outline",onClick:function(){b("phone"),P(""),Z(null)},disabled:t,children:"Back"})]})]}),"password"===N&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(o._,{htmlFor:"password",children:"2FA Password"}),(0,a.jsx)(l.I,{id:"password",type:"password",placeholder:"Enter your 2FA password",value:T,onChange:function(e){return E(e.target.value)},required:!0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Enter your two-factor authentication password"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(c.z,{onClick:V,disabled:t||!T,className:"flex-1",children:[t&&(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Authenticate"]}),(0,a.jsx)(c.z,{variant:"outline",onClick:function(){b("code"),E(""),O(!1)},disabled:t,children:"Back"})]})]}),"completed"===N&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(x,{className:"h-5 w-5"}),(0,a.jsx)("p",{className:"font-medium",children:"Authentication successful!"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"You are now authenticated with Telegram. You can start adding channels."}),(0,a.jsx)(c.z,{variant:"outline",onClick:function(){b("api"),C(""),P(""),E(""),Z(null),O(!1)},children:"Reset Authentication"})]})]})]})]})]})})}}},function(e){e.O(0,[714,97,210,774,888,179],(function(){return t=2837,e(e.s=t);var t}));var t=e.O();_N_E=t}]);