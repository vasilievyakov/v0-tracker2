(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(4174)}])},4174:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ze}});var s=a(7568),n=a(7582),r=a(5893),l=a(2038),c=a(9815),i=a(1799),o=a(9534),d=a(7294),u=a(2461);function m(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",(0,i.Z)({"data-slot":"table",className:(0,u.cn)("w-full caption-bottom text-sm",t)},a))})}function h(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("thead",(0,i.Z)({"data-slot":"table-header",className:(0,u.cn)("[&_tr]:border-b",t)},a))}function x(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("tbody",(0,i.Z)({"data-slot":"table-body",className:(0,u.cn)("[&_tr:last-child]:border-0",t)},a))}function g(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("tr",(0,i.Z)({"data-slot":"table-row",className:(0,u.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t)},a))}function p(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("th",(0,i.Z)({"data-slot":"table-head",className:(0,u.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t)},a))}function v(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("td",(0,i.Z)({"data-slot":"table-cell",className:(0,u.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t)},a))}var f=a(4345),j=a(8426),N=a(2003),b=(0,N.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function w(e){var t=e.className,a=e.variant,s=e.asChild,n=void 0!==s&&s,l=(0,o.Z)(e,["className","variant","asChild"]),c=n?j.g7:"span";return(0,r.jsx)(c,(0,i.Z)({"data-slot":"badge",className:(0,u.cn)(b({variant:a}),t)},l))}var Z=a(5739),y=a(5283),_=a(6784),C=a(3766),z=a(3025),k=a(4464),S=a(7420),E=a(5097),T=a(7307),L=a(8814),V=a(2558);function F(e){var t=e.posts,a=function(e){if(!e)return null;switch(e){case"photo":return(0,r.jsx)(y.Z,{className:"h-4 w-4"});case"video":return(0,r.jsx)(_.Z,{className:"h-4 w-4"});case"document":return(0,r.jsx)(C.Z,{className:"h-4 w-4"});default:return null}};return(0,r.jsxs)(f.Zb,{className:"border-none shadow-sm",children:[(0,r.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between",children:[(0,r.jsxs)(f.ll,{className:"text-xl font-semibold text-slate-900",children:["Posts (",t.length,")"]}),(0,r.jsxs)(Z.z,{onClick:function(){var e=t.map((function(e){var t,a;return[(null===(t=e.channel)||void 0===t?void 0:t.channel_name)||e.channel_username,(e.content||"").replace(/"/g,'""').substring(0,200),e.published_at,e.views_count.toString(),e.reactions_count.toString(),e.comments_count.toString(),e.forwards_count.toString(),(null===(a=e.engagement_rate)||void 0===a?void 0:a.toString())||"",e.post_url]})),a=[["Channel","Content","Published","Views","Reactions","Comments","Forwards","Engagement Rate","URL"]].concat((0,c.Z)(e)).map((function(e){return e.map((function(e){return'"'.concat(e,'"')})).join(",")})).join("\n"),s=new Blob([a],{type:"text/csv"}),n=window.URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="telegram-posts-".concat((new Date).toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(n)},variant:"outline",size:"sm",children:[(0,r.jsx)(z.Z,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]}),(0,r.jsx)(f.aY,{children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)(m,{children:[(0,r.jsx)(h,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(p,{className:"w-[200px]",children:"Channel"}),(0,r.jsx)(p,{className:"w-[400px]",children:"Content"}),(0,r.jsx)(p,{children:"Published"}),(0,r.jsx)(p,{className:"text-right",children:"Views"}),(0,r.jsx)(p,{className:"text-right",children:"Engagement"}),(0,r.jsx)(p,{children:"Stats"}),(0,r.jsx)(p,{className:"text-right",children:"Actions"})]})}),(0,r.jsx)(x,{children:0===t.length?(0,r.jsx)(g,{children:(0,r.jsx)(v,{colSpan:7,className:"h-24 text-center text-slate-500",children:"No posts found. Try adjusting your filters or add a channel."})}):t.map((function(e){var t,s;return(0,r.jsxs)(g,{children:[(0,r.jsx)(v,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-semibold text-slate-900",children:(null===(t=e.channel)||void 0===t?void 0:t.channel_name)||e.channel_username}),(null===(s=e.channel)||void 0===s?void 0:s.category)&&(0,r.jsx)(w,{variant:"secondary",className:"mt-1 text-xs",children:e.channel.category})]})}),(0,r.jsx)(v,{children:(0,r.jsxs)("div",{className:"max-w-md",children:[(0,r.jsx)("p",{className:"line-clamp-2 text-sm text-slate-700",children:e.content||"No content"}),e.has_media&&e.media_type&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-1 text-xs text-slate-500",children:[a(e.media_type),(0,r.jsx)("span",{className:"capitalize",children:e.media_type})]})]})}),(0,r.jsx)(v,{children:(0,r.jsx)("span",{className:"text-sm text-slate-600",children:(0,V.Q)(new Date(e.published_at),{addSuffix:!0})})}),(0,r.jsx)(v,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,r.jsx)(k.Z,{className:"h-4 w-4 text-slate-400"}),(0,r.jsx)("span",{className:"font-semibold",children:e.views_count.toLocaleString()})]})}),(0,r.jsx)(v,{className:"text-right",children:e.engagement_rate&&(0,r.jsxs)("span",{className:"font-medium text-green-600",children:[e.engagement_rate,"%"]})}),(0,r.jsx)(v,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 text-xs text-slate-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(S.Z,{className:"h-3 w-3"}),e.reactions_count]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(E.Z,{className:"h-3 w-3"}),e.comments_count]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(T.Z,{className:"h-3 w-3"}),e.forwards_count]})]})}),(0,r.jsx)(v,{className:"text-right",children:(0,r.jsx)(Z.z,{variant:"ghost",size:"sm",asChild:!0,children:(0,r.jsx)("a",{href:e.post_url,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(L.Z,{className:"h-4 w-4"})})})})]},e.id)}))})]})})})]})}var R=a(1163),U=a(2685),A=a(872),I=a(9396),P=a(2067),D=a(8971),O=a(3742),q=a(4979);function M(e){var t=(0,A.Z)({},e);return(0,r.jsx)(P.fC,(0,i.Z)({"data-slot":"select"},t))}function Y(e){var t=(0,A.Z)({},e);return(0,r.jsx)(P.B4,(0,i.Z)({"data-slot":"select-value"},t))}function B(e){var t=e.className,a=e.size,s=void 0===a?"default":a,n=e.children,l=(0,o.Z)(e,["className","size","children"]);return(0,r.jsxs)(P.xz,(0,I.Z)((0,i.Z)({"data-slot":"select-trigger","data-size":s,className:(0,u.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},l),{children:[n,(0,r.jsx)(P.JO,{asChild:!0,children:(0,r.jsx)(D.Z,{className:"size-4 opacity-50"})})]}))}function K(e){var t=e.className,a=e.children,s=e.position,n=void 0===s?"popper":s,l=(0,o.Z)(e,["className","children","position"]);return(0,r.jsx)(P.h_,{children:(0,r.jsxs)(P.VY,(0,I.Z)((0,i.Z)({"data-slot":"select-content",className:(0,u.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n},l),{children:[(0,r.jsx)(X,{}),(0,r.jsx)(P.l_,{className:(0,u.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,r.jsx)(J,{})]}))})}function G(e){var t=e.className,a=e.children,s=(0,o.Z)(e,["className","children"]);return(0,r.jsxs)(P.ck,(0,I.Z)((0,i.Z)({"data-slot":"select-item",className:(0,u.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t)},s),{children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(P.wU,{children:(0,r.jsx)(O.Z,{className:"size-4"})})}),(0,r.jsx)(P.eT,{children:a})]}))}function X(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)(P.u_,(0,I.Z)((0,i.Z)({"data-slot":"select-scroll-up-button",className:(0,u.cn)("flex cursor-default items-center justify-center py-1",t)},a),{children:(0,r.jsx)(q.Z,{className:"size-4"})}))}function J(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)(P.$G,(0,I.Z)((0,i.Z)({"data-slot":"select-scroll-down-button",className:(0,u.cn)("flex cursor-default items-center justify-center py-1",t)},a),{children:(0,r.jsx)(D.Z,{className:"size-4"})}))}var Q=a(7764),W=a(1352);function $(e){var t=e.channels,a=(0,R.useRouter)(),s=a.query,n=(0,d.useState)(s.search||""),l=n[0],c=n[1],i=(0,d.useState)(s.channelUsername||"all"),o=i[0],u=i[1],m=(0,d.useState)(s.minViews||""),h=m[0],x=m[1],g=(0,d.useState)(s.minEngagement||""),p=g[0],v=g[1],j=(0,d.useState)(s.hasMedia||"all"),N=j[0],b=j[1],w=function(){var e=new URLSearchParams;l&&e.set("search",l),o&&"all"!==o&&e.set("channelUsername",o),h&&e.set("minViews",h),p&&e.set("minEngagement",p),N&&"all"!==N&&e.set("hasMedia",N),a.push("/?".concat(e.toString()))};return(0,r.jsx)(f.Zb,{className:"mb-6 border-none shadow-sm",children:(0,r.jsxs)(f.aY,{className:"pt-6",children:[(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(Q.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,r.jsx)(U.I,{placeholder:"Search in content...",value:l,onChange:function(e){return c(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&w()},className:"pl-9"})]})}),(0,r.jsxs)(M,{value:o,onValueChange:u,children:[(0,r.jsx)(B,{children:(0,r.jsx)(Y,{placeholder:"All channels"})}),(0,r.jsxs)(K,{children:[(0,r.jsx)(G,{value:"all",children:"All channels"}),t.map((function(e){return(0,r.jsx)(G,{value:e.channel_username,children:e.channel_name},e.id)}))]})]}),(0,r.jsx)(U.I,{type:"number",placeholder:"Min views",value:h,onChange:function(e){return x(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&w()}}),(0,r.jsx)(U.I,{type:"number",placeholder:"Min engagement %",value:p,onChange:function(e){return v(e.target.value)},onKeyDown:function(e){return"Enter"===e.key&&w()}})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,r.jsxs)(M,{value:N,onValueChange:b,children:[(0,r.jsx)(B,{className:"w-[180px]",children:(0,r.jsx)(Y,{placeholder:"Media type"})}),(0,r.jsxs)(K,{children:[(0,r.jsx)(G,{value:"all",children:"All posts"}),(0,r.jsx)(G,{value:"true",children:"With media"}),(0,r.jsx)(G,{value:"false",children:"Text only"})]})]}),(0,r.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,r.jsxs)(Z.z,{onClick:function(){c(""),u("all"),x(""),v(""),b("all"),a.push("/")},variant:"outline",size:"sm",children:[(0,r.jsx)(W.Z,{className:"mr-2 h-4 w-4"}),"Clear"]}),(0,r.jsxs)(Z.z,{onClick:w,size:"sm",children:[(0,r.jsx)(Q.Z,{className:"mr-2 h-4 w-4"}),"Apply Filters"]})]})]})]})})}var H=a(9858);function ee(e){var t=e.posts,a=t.length,s=t.reduce((function(e,t){return e+t.views_count}),0),n=t.reduce((function(e,t){return e+(t.engagement_rate||0)}),0)/(t.length||1),l=t.reduce((function(e,t){return e+t.reactions_count+t.comments_count+t.forwards_count}),0),c=[{title:"Total Posts",value:a.toLocaleString(),icon:C.Z,color:"text-blue-600",bgColor:"bg-blue-50"},{title:"Total Views",value:s.toLocaleString(),icon:k.Z,color:"text-green-600",bgColor:"bg-green-50"},{title:"Avg Engagement",value:"".concat(n.toFixed(1),"%"),icon:H.Z,color:"text-purple-600",bgColor:"bg-purple-50"},{title:"Total Interactions",value:l.toLocaleString(),icon:E.Z,color:"text-orange-600",bgColor:"bg-orange-50"}];return(0,r.jsx)("div",{className:"mb-8 grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:c.map((function(e){return(0,r.jsxs)(f.Zb,{className:"border-none shadow-sm",children:[(0,r.jsxs)(f.Ol,{className:"flex flex-row items-center justify-between pb-2",children:[(0,r.jsx)(f.ll,{className:"text-sm font-medium text-slate-600",children:e.title}),(0,r.jsx)("div",{className:"rounded-lg p-2 ".concat(e.bgColor),children:(0,r.jsx)(e.icon,{className:"h-4 w-4 ".concat(e.color)})})]}),(0,r.jsx)(f.aY,{children:(0,r.jsx)("div",{className:"text-2xl font-bold text-slate-900",children:e.value})})]},e.title)}))})}var te=a(2670),ae=a(6327);function se(e){var t=(0,A.Z)({},e);return(0,r.jsx)(ae.fC,(0,i.Z)({"data-slot":"dialog"},t))}function ne(e){var t=(0,A.Z)({},e);return(0,r.jsx)(ae.xz,(0,i.Z)({"data-slot":"dialog-trigger"},t))}function re(e){var t=(0,A.Z)({},e);return(0,r.jsx)(ae.h_,(0,i.Z)({"data-slot":"dialog-portal"},t))}function le(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)(ae.aV,(0,i.Z)({"data-slot":"dialog-overlay",className:(0,u.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t)},a))}function ce(e){var t=e.className,a=e.children,s=e.showCloseButton,n=void 0===s||s,l=(0,o.Z)(e,["className","children","showCloseButton"]);return(0,r.jsxs)(re,{"data-slot":"dialog-portal",children:[(0,r.jsx)(le,{}),(0,r.jsxs)(ae.VY,(0,I.Z)((0,i.Z)({"data-slot":"dialog-content",className:(0,u.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t)},l),{children:[a,n&&(0,r.jsxs)(ae.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(W.Z,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})}function ie(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("div",(0,i.Z)({"data-slot":"dialog-header",className:(0,u.cn)("flex flex-col gap-2 text-center sm:text-left",t)},a))}function oe(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("div",(0,i.Z)({"data-slot":"dialog-footer",className:(0,u.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t)},a))}function de(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)(ae.Dx,(0,i.Z)({"data-slot":"dialog-title",className:(0,u.cn)("text-lg leading-none font-semibold",t)},a))}function ue(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)(ae.dk,(0,i.Z)({"data-slot":"dialog-description",className:(0,u.cn)("text-muted-foreground text-sm",t)},a))}var me=a(3223),he=a(1012),xe=a(6209),ge=a(767);function pe(){var e=(0,d.useState)(!1),t=e[0],a=e[1],l=(0,d.useState)(!1),c=l[0],i=l[1],o=(0,d.useState)("month"),u=o[0],m=o[1],h=(0,R.useRouter)(),x=(0,ge.pm)().toast,g=function(){var e=(0,s.Z)((function(e){var t,s,r,l;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:e.preventDefault(),i(!0),t=new FormData(e.currentTarget),s=t.get("channel_url"),n.label=1;case 1:return n.trys.push([1,3,4,5]),console.log("[v0] [CLIENT] Adding channel:",s,"with time range:",u),[4,(0,xe.cY)(s,u)];case 2:return r=n.sent(),console.log("[v0] [CLIENT] Result received:",r),r.success?(x({title:"Channel added",description:r.message||"The channel and its posts have been successfully added."}),a(!1),e.currentTarget.reset(),h.refresh()):(console.error("[v0] [CLIENT] Error from server:",r.error),x({title:"Error",description:r.error||"Failed to add channel.",variant:"destructive"})),[3,5];case 3:return l=n.sent(),console.error("[v0] [CLIENT] Exception adding channel:",l),x({title:"Error",description:"An unexpected error occurred: "+((0,te.Z)(l,Error)?l.message:"Unknown error"),variant:"destructive"}),[3,5];case 4:return i(!1),[7];case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();return(0,r.jsxs)(se,{open:t,onOpenChange:a,children:[(0,r.jsx)(ne,{asChild:!0,children:(0,r.jsxs)(Z.z,{size:"lg",className:"gap-2",children:[(0,r.jsx)(he.Z,{className:"h-5 w-5"}),"Add Channel"]})}),(0,r.jsx)(ce,{className:"max-w-md",children:(0,r.jsxs)("form",{onSubmit:g,children:[(0,r.jsxs)(ie,{children:[(0,r.jsx)(de,{children:"Add New Channel"}),(0,r.jsx)(ue,{children:"Enter a Telegram channel URL to automatically fetch posts and track data."})]}),(0,r.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(me._,{htmlFor:"channel_url",children:"Channel URL"}),(0,r.jsx)(U.I,{id:"channel_url",name:"channel_url",placeholder:"https://t.me/techcrunch",required:!0}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supported formats: https://t.me/channel, t.me/channel, or @channel"})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)(me._,{htmlFor:"time_range",children:"Time Range"}),(0,r.jsxs)(M,{value:u,onValueChange:function(e){return m(e)},children:[(0,r.jsx)(B,{id:"time_range",children:(0,r.jsx)(Y,{placeholder:"Select time range"})}),(0,r.jsxs)(K,{children:[(0,r.jsx)(G,{value:"all",children:"All posts (entire history)"}),(0,r.jsx)(G,{value:"year",children:"Last year"}),(0,r.jsx)(G,{value:"month",children:"Last month"}),(0,r.jsx)(G,{value:"update",children:"Update with new posts only"})]})]}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["all"===u&&"Fetch all available posts from the channel","year"===u&&"Fetch posts from the last 12 months","month"===u&&"Fetch posts from the last 30 days","update"===u&&"Only add new posts since last update"]})]})]}),(0,r.jsxs)(oe,{children:[(0,r.jsx)(Z.z,{type:"button",variant:"outline",onClick:function(){return a(!1)},children:"Cancel"}),(0,r.jsx)(Z.z,{type:"submit",disabled:c,children:c?"Fetching...":"Add Channel"})]})]})})]})}var ve=(0,N.j)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function fe(e){var t=e.className,a=e.variant,s=(0,o.Z)(e,["className","variant"]);return(0,r.jsx)("div",(0,i.Z)({"data-slot":"alert",role:"alert",className:(0,u.cn)(ve({variant:a}),t)},s))}function je(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("div",(0,i.Z)({"data-slot":"alert-title",className:(0,u.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t)},a))}function Ne(e){var t=e.className,a=(0,o.Z)(e,["className"]);return(0,r.jsx)("div",(0,i.Z)({"data-slot":"alert-description",className:(0,u.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t)},a))}var be=a(3510),we=a(889);function Ze(){var e=(0,d.useState)(!1),t=e[0],a=e[1],l=(0,d.useState)(!1),c=l[0],i=l[1],o=(0,d.useState)(null),u=o[0],m=o[1],h=function(){var e=(0,s.Z)((function(){var e,t;return(0,n.__generator)(this,(function(s){switch(s.label){case 0:a(!0),m(null),s.label=1;case 1:return s.trys.push([1,4,5,6]),[4,fetch("/api/setup-database",{method:"POST"})];case 2:return[4,s.sent().json()];case 3:return(e=s.sent()).success?(i(!0),setTimeout((function(){window.location.reload()}),2e3)):m(e.error||"Failed to setup database"),[3,6];case 4:return t=s.sent(),m(t.message||"An error occurred"),[3,6];case 5:return a(!1),[7];case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return c?(0,r.jsxs)(fe,{className:"mb-6 border-green-500 bg-green-50",children:[(0,r.jsx)(O.Z,{className:"h-4 w-4 text-green-600"}),(0,r.jsx)(je,{className:"text-green-900",children:"Setup Complete!"}),(0,r.jsx)(Ne,{className:"text-green-800",children:"Database has been set up successfully. Reloading..."})]}):(0,r.jsxs)(fe,{className:"mb-6",children:[(0,r.jsx)(be.Z,{className:"h-4 w-4"}),(0,r.jsx)(je,{children:"Database Setup Required"}),(0,r.jsxs)(Ne,{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"flex-1",children:"The database tables need to be created. Click the button to set up the database with sample data."}),(0,r.jsx)(Z.z,{onClick:h,disabled:t,size:"sm",children:t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(we.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Setting up..."]}):"Setup Database"})]}),u&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:["Error: ",u]})]})}var ye=a(1664),_e=a.n(ye),Ce=a(1408);function ze(e){return ke.apply(this,arguments)}function ke(){return(ke=(0,s.Z)((function(e){var t,a,s,c,i,o,d,u,m,h,x,g,p;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return t=e.searchParams,a=t||{},[4,(0,l.e)()];case 1:s=n.sent(),c=!0,i=null,o=null,n.label=2;case 2:return n.trys.push([2,6,,7]),d=s.from("posts").select("\n        *,\n        channel:channels(*)\n      ").order("published_at",{ascending:!1}),a.search&&(d=d.ilike("content","%".concat(a.search,"%"))),a.channelUsername&&(d=d.eq("channel_username",a.channelUsername)),a.minViews&&(d=d.gte("views_count",parseInt(a.minViews))),a.maxViews&&(d=d.lte("views_count",parseInt(a.maxViews))),a.minEngagement&&(d=d.gte("engagement_rate",parseFloat(a.minEngagement))),"true"===a.hasMedia&&(d=d.eq("has_media",!0)),a.dateFrom&&(d=d.gte("published_at",a.dateFrom)),a.dateTo&&(d=d.lte("published_at",a.dateTo)),[4,d];case 3:return u=n.sent(),m=u.data,(h=u.error)?"PGRST205"===h.code||h.message.includes("Could not find the table")?(console.log("[v0] Posts table not found, database setup required"),c=!1):console.error("Error fetching posts:",h):i=m,c?[4,s.from("channels").select("*").order("channel_name")]:[3,5];case 4:x=n.sent(),g=x.data,o=g,n.label=5;case 5:return[3,7];case 6:return p=n.sent(),console.error("[v0] Error in database query:",p),c=!1,[3,7];case 7:return[2,(0,r.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl p-6 lg:p-8",children:[(0,r.jsxs)("div",{className:"mb-8 flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-4xl font-bold tracking-tight text-slate-900",children:"Telegram Posts Tracker"}),(0,r.jsx)("p",{className:"mt-2 text-lg text-slate-600",children:"Monitor and analyze posts from Telegram channels"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(_e(),{href:"/settings",children:(0,r.jsxs)(Z.z,{variant:"outline",size:"lg",className:"gap-2",children:[(0,r.jsx)(Ce.Z,{className:"h-5 w-5"}),"Settings"]})}),(0,r.jsx)(pe,{})]})]}),c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ee,{posts:i||[]}),(0,r.jsx)($,{channels:o||[]}),(0,r.jsx)(F,{posts:i||[]})]}):(0,r.jsx)(Ze,{})]})})]}}))}))).apply(this,arguments)}}},function(e){e.O(0,[714,97,715,210,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);