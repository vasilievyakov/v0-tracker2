(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[802],{4414:function(e,n,t){"use strict";t.r(n),t.d(n,{fetchChannelData:function(){return S},getTelegramClient:function(){return y},initializeTelegramAuth:function(){return v}});var r=t(7568),s=t(2670),a=t(7582),i=t(9769),o=t(7247),c=t(8349),u=t(2038),l=t(2052),h=null,p=!1;function f(){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)((function(){var e,n,t,r;return(0,a.__generator)(this,(function(s){switch(s.label){case 0:return[4,(0,u.e)()];case 1:return[4,s.sent().from("api_settings").select("api_id, api_hash").eq("id",1).maybeSingle()];case 2:if(e=s.sent(),!(n=e.data)||!n.api_id||!n.api_hash)throw new Error("API credentials not found. Please configure them in settings.");if(t=parseInt((0,l.p)(n.api_id)),r=(0,l.p)(n.api_hash),isNaN(t)||!r)throw new Error("Invalid API credentials format.");return[2,{apiId:t,apiHash:r}]}}))}))).apply(this,arguments)}function w(){return g.apply(this,arguments)}function g(){return(g=(0,r.Z)((function(){var e,n;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,u.e)()];case 1:return[4,t.sent().from("telegram_sessions").select("session_string").eq("id",1).maybeSingle()];case 2:if(e=t.sent(),!(n=e.data)||!n.session_string)return[2,null];try{return[2,(0,l.p)(n.session_string)]}catch(r){return console.error("Failed to decrypt session:",r),[2,null]}return[2]}}))}))).apply(this,arguments)}function _(e,n){return m.apply(this,arguments)}function m(){return(m=(0,r.Z)((function(e,n){var t,r,s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,(0,u.e)()];case 1:return t=a.sent(),r=(0,l.H)(e),[4,t.from("telegram_sessions").upsert({id:1,session_string:r,phone_number:n||null,updated_at:(new Date).toISOString()})];case 2:if(s=a.sent().error)throw new Error("Failed to save session: ".concat(s.message));return[2]}}))}))).apply(this,arguments)}function y(){return b.apply(this,arguments)}function b(){return(b=(0,r.Z)((function(){var e,n,t,r,s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return h&&h.connected?[2,h]:p?[4,new Promise((function(e){return setTimeout(e,1e3)}))]:[3,2];case 1:return a.sent(),[2,y()];case 2:p=!0,a.label=3;case 3:return a.trys.push([3,9,10,11]),[4,f()];case 4:return e=a.sent(),[4,w()];case 5:return n=a.sent(),t=new o.StringSession(n||""),(r=new i.TelegramClient(t,e.apiId,e.apiHash,{connectionRetries:5})).connected?[3,7]:[4,r.connect()];case 6:a.sent(),a.label=7;case 7:if(!n)throw new Error("No session found. Please authenticate first.");return[4,r.checkAuthorization()];case 8:if(!a.sent())throw new Error("Session expired. Please re-authenticate.");return h=r,[2,r];case 9:throw s=a.sent(),console.error("Error initializing Telegram client:",s),s;case 10:return p=!1,[7];case 11:return[2]}}))}))).apply(this,arguments)}function v(e,n,t){return E.apply(this,arguments)}function E(){return(E=(0,r.Z)((function(e,n,t){var r,s,u,l,h,p,d,w;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,f()];case 1:return r=a.sent(),s=new o.StringSession(""),[4,(u=new i.TelegramClient(s,r.apiId,r.apiHash,{connectionRetries:5})).connect()];case 2:a.sent(),a.label=3;case 3:return a.trys.push([3,,11,13]),[4,u.sendCode({apiId:r.apiId,apiHash:r.apiHash},e)];case 4:return l=a.sent(),h=l.phoneCodeHash,[4,n(h)];case 5:p=a.sent(),a.label=6;case 6:return a.trys.push([6,8,,9]),[4,u.invoke(new c.Api.auth.SignIn({phoneNumber:e,phoneCodeHash:h,phoneCode:p}))];case 7:return a.sent(),[3,9];case 8:if("SESSION_PASSWORD_NEEDED"===(d=a.sent()).errorMessage&&t)throw new Error("2FA password verification is not implemented. Please disable 2FA for this account.");throw d;case 9:return[4,_(w=u.session.save(),e)];case 10:return a.sent(),[2,w];case 11:return[4,u.disconnect()];case 12:return a.sent(),[7];case 13:return[2]}}))}))).apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return C=(0,r.Z)((function(e){var n,t,r,i,o,u,l,h,p=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:"month",[4,y()];case 1:t=a.sent(),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,t.invoke(new c.Api.contacts.ResolveUsername({username:e.replace("@","")}))];case 3:if(r=a.sent(),!(0,s.Z)(r.chats[0],c.Api.Channel))throw new Error("Resolved entity is not a channel");return i=r.chats[0],o=i.id,[4,t.invoke(new c.Api.channels.GetFullChannel({channel:o}))];case 4:switch(u=a.sent(),u.fullChat,u.chats[0],n){case"all":l=63072e6;break;case"year":l=31536e6;break;case"month":default:l=2592e6;break;case"update":l=6048e5}return Math.floor((Date.now()-l)/1e3),[],0,!0,"all"===n?100:"year"===n?50:"month"===n?30:10,[2,{title:e,subscribers:0,description:"Temporarily disabled"||null,category:"Other",language:"English",posts:[]}];case 5:throw h=a.sent(),console.error("Error fetching channel data:",h),h;case 6:return[2]}}))})),C.apply(this,arguments)}},5723:function(){},3818:function(){},6782:function(){},9456:function(){},5644:function(){},2012:function(){}}]);